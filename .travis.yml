language: scala

if: (type = push AND (branch IN (master, develop) OR tag IS present)) OR type IN (pull_request, api, cron)

scala:
  - 2.12.11
jdk:
  - openjdk8
script:
  - sbt +test

before_cache:
  - rm -fv $HOME/.ivy2/.sbt.ivy.lock
  - find $HOME/.ivy2/cache -name "ivydata-*.properties" -print -delete
  - find $HOME/.sbt        -name "*.lock"               -print -delete
cache:
  directories:
    - $HOME/.cache/coursier
    - $HOME/.ivy2/cache
    - $HOME/.sbt

before_deploy:
  - sudo python -m easy_install --upgrade pyOpenSSL # https://stackoverflow.com/questions/43267157/python-attributeerror-module-object-has-no-attribute-ssl-st-init
  - pip install --user release-manager==0.4.1
deploy:
  - provider: script
    skip_cleanup: true
    script: ".travis/deploy.sh $TRAVIS_TAG"
    on:
      tags: true

env:
  global:
    - secure: OwDQjRQ4NGdKgDPemXjihEhulIwp/KvoHU4pwaTjq5H+3ZCzj+1VRetMn8goUKaul5EJEsweTiv7u11Oa8urkOlW82wYpTSsWiJHqqLDLh+1PBjou6oTNvzalRoUPwyTQk9RqzmiLYXd2zrPcf8cMK784oOZyV1Q6ayqSsZ9wmWdn9w5o9gJOZMuvh3v5mLg81NYALglHS/a6//yFtxtq1SSho7A1N62/opDH414qfWR/FudD0w49z3PmnFUuc1wwm20XvOxRWAZqyQIUWvKt2HDNbdr0r0LonZiCX+qsEsZUycBX+WdZDDnTQoMDC+VtPZiZXexUlbVYQ9GiSezoiLbsNtdqe8jg8IqrbgfOxKjyjM8oqZD/APs6KVE0FceGywv6pcRk2OAftpv5YJH0ZX/ucw4naXtNQo6/gJ5SvxH4VJ3YZdCJYtIU3D1dp45wqPsX/7pSG/NjTmmkTGIi6YwzoZtAf/GdvcqrfqiGmdUlHPgvynW6CdVYSonavQu7L7nCk/ttM5KUVWcdwKilyNVDrvArsYEtzhmh6SMmCMC+9FBmCEv3PEfseN6hv+9Krj0EipkvTou14Y0sDg641fvV6ULomCR1c1G/H8m9aUrHmhe1URnKn94A15q8Fde5zMO+k3qyLMtd2g2EhqsLZFYZrnZDfxcnU/MrOSWJuU=
    - secure: beyWvROFRw3TTQ1Jfj5/IP5SXk++x0hA2Nsjwyn3VUmNIEhvfZGbqJ49MTx/o9MvWJgPcQ1UM7tMYE/QMH1vTuE/OqgK7LFBTHYjcBaQFb5QiZacHrx0Pl0wI+jMSu/ivt/RZL3r+H41Ng9s3FtNk4o54Vdywp8P0303F6YE1EQomZRHMN3vtQ9YA2a0hEsYj78agGOMEuElrkg+t3icjFW4NJxWGOV4zv+CEO/CagIak3vaH7VhklkBmQWOphnuKM2d27saGjpImA3W9qPAVOv4XSpjZd0HdZbGHFgZ+VtiZlHt7wgBswfm5c1Cuk7ICKZ4gTTYxvYqpLsKCALyZgpDBijLBs/BK29xTsqXIQHskykCX6YCtTz15GrcESsAfo3kiuDhMLWLEzGP6ARYoiidjFZAU9oBFgM/lEsYXQ1ZxgQ9VHq8SaF0C7at4XiO9i7xGIRjhDPxqrkl4LuStZXYsyPxLMUci1xY12uiFJ6G6XWnpvXc5PaxSlk2oyxSMrsPbtpqddXTvaYFqe8EKUuHa7xYbJrRrDoiwz+oFGxWv09epXTn/+FAsFEVWUpVtfo+lSh9kqibCS4JXwibOl0zPB3/tSmIdOeWjyMr3XiLYgqwgYjFNC4/zNxfuF2JSn6EOXr9wI4l3zoJwSpshs/O0kx6nQInxi1+MS4+GME=
    - secure: Kwg9Ih3ER5ASp7XFWcPZ8/IAa3FiGYyJ35Bw18h5FIG349LeEHeBna2MfA975zhLjxX7nHGDLGhWNRLH/OupkbVbFCHL28UI3tI9oHgVpPgt9xzzS22NPdH5f+ERnCJw0ec+8oj5JK7D+QRwIyaOAn6h23hT9Aj/foQSFT8HE9Wqq5sA9tJxS5QX40U/09rmW2MVQ8KRZKz8qWx8pBen2K842nMvOAVU22aurDL+rUhXgrpuTDcY0G7PjO9rpV6A+m0fdf/b0U9PVZkhZap4UAGrQ3haTqDhGO84E/aXjtg0BHnvjH5pqWAU/erXgkKAOgQCuk6UlD5qGHzAXYXNeUYxDooIm9qbn4tmu7fa3OLEzUxPL+5LeIs5++NRRrxA9AeNXEwSA+XxogV5Zj5dKxSYdP9wpCyNrMAer4GkczypJYkacKn38wev2QcOLf78j5ZHb3Ya+q/dCzQMR7of6WClgTTTdq3j8RF7ufmKvbywpS6qdCGCRdRQdF2snoOK8kMjLON/CN5X2QYUe+/nyQYp+Z2pFe/QZj01PXNjc+9kJPk6YtabPh4YSo41urMAmDXV46LGwyUih3i/yomZuZ9L6TD5ExamT6E5SHxLNB3fJj+jaAknaClAaJxr0ok00qMzwejdeQjChJumodGlpJsglt9AdfP1ZJWWMWFrkDA=
    - secure: aRIurRCs1zrKoae9LFAW+M1MSjWHJEi4vvqe/tIMQNW1DKNsCNJA4KI1qRUq/iwci42tYW7bgaRvkrJbWzNSUxdoC4IqrGPWXnEyL45D0+izI2QWqUg/uY8CAvGoiYWkwO0X3pWrT22RnpMh9PjoXKcRKNFpZCQNYEDwosTAKkN7rPLtaHdIQigiwwfbO7KGTjaM1TtG8uY50gXbbA6rLnUqrNpKpgTlFA+QbarFgc8nWsO/wpWP2ZZik11/urTmzVVJ6R4DeLs+H+GyXIUN/N6W1bAvvZ9WDow79yR0ppU3LwBMn0i1i8KIdpka854ktNHZ5+QnmUM+5pfZZ/yXuWHpz1k04NLpzsZC2hwkdTJhCQtwfd0QZf/wRlxlxUo6+y5Um/JUExY5X9OLnJzPd2ygsWgI45WRKsIRhUYHVGRvdDDrymPLX74fumBsTvYd1i0IvV2G0RWGFbBwIdsnLozNJkEF/YzxcUoGKklvdoZwz0HxRcj+byuQpiItY9fiTBD/xKk0jRKx06ulLXe28sv8TZLmxWRlihK4dGK1WHqvO+xymbekPAyjG8lWJMLIneMXNLxriRGdDIzn+Xj6gqQ727p2qUlqKHh/kNFIoJY89eomaL3ptj2i0/uIyXt3mOPGZTtqTd/s/auJeM5sLHGtXiX/9Bq7fnj55AreIMs=